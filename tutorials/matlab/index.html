<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>MATLAB</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="MATLAB" />
<meta property="og:locale" content="en_US" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"MATLAB","url":"/tutorials/matlab/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/"></a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/tutorials/">Tutorials</a><a class="page-link" href="/hardware/">Hardware</a><a class="page-link" href="/faq/">FAQ</a><a class="page-link" href="https://github.com/mahilab/Syntacts" target="_blank">Github</a>
          <a class="page-link" href="https://github.com/mahilab/Syntacts/releases" target="_blank">Download</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">MATLAB</h1>
  </header>

  <div class="post-content">
    <h2 id="introduction">Introduction</h2>
<p>Although Syntacts does not yet officially provide a wrapper for MATLAB, it is still possible to load and use the raw Syntacts C library. This tutorial will demonstrate how to set this up and basic usage. For a comprehensive guide to Syntact’s API, refer to the <a href="/tutorials/cpp">C++ API tutorial</a>. The interface will not be exactly the same since C does not have classes, but the names of the exported C functions are such that you should be able to figure things out (e.g. <code class="highlighter-rouge">Session.play(...)</code> in C++ will be <code class="highlighter-rouge">Session_play(...)</code> in C).</p>

<h2 id="requirements">Requirements</h2>

<ul>
  <li>MATLAB</li>
  <li>compatible C/C++ compiler</li>
  <li>latest <a href="https://github.com/mahilab/Syntacts/releases">Syntacts Release</a></li>
</ul>

<h2 id="setting-up-the-matlab-compiler">Setting Up the MATLAB Compiler</h2>

<p>To import the Syntacts library into MATLAB, you first need to have installed a compatible C/C++ compiler. This <a href="https://www.mathworks.com/support/requirements/supported-compilers.html">table</a> lists the various compilers compatible with each MATLAB release.</p>

<p>Unless you decide to build the Syntacts C library from source using your own compiler, you need to also ensure that your compiler is compatible with compiler that was used to build the Syntacts Release:</p>

<ul>
  <li>On Windows, we use MSVC to build Syntacts. Versions 2015, 2017, and 2019 should work. MinGW <em>may</em> work. Feel free to try.</li>
  <li>On macOS, we use XCode (i.e. Apple Clang) to build Syntacts. Install the latest version of XCode from the Apple Store.</li>
</ul>

<p>For this example, we will use MATLAB 2020b and MSVC 2019 on Windows 10.</p>

<h2 id="loading-syntacts-into-matlab">Loading Syntacts into MATLAB</h2>

<ul>
  <li>From the <code class="highlighter-rouge">c</code> folder in the latest Syntacts Release, extract <code class="highlighter-rouge">syntacts.h</code> and <code class="highlighter-rouge">syntacts.dll</code> (or <code class="highlighter-rouge">syntacts.dylib</code> on macOS) to a location of your choice.</li>
  <li>Open MATLAB and set the working directory to the location containing the header file and library.</li>
  <li>The following code can be used to load Syntacts:
    <div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">loadlibrary</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>You can list the available functions with:
    <div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">libfunctions</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">)</span>
</code></pre></div>    </div>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ADSR_create                       Session_open1                     
  ASR_create                        Session_open2                     
  Add_FltSig                        Session_open3   
  ...
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="using-syntacts-from-matlab">Using Syntacts from MATLAB</h2>

<p>Once the library is loaded, you can create a Syntacts Session and open a device:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s</span> <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_create'</span><span class="p">);</span>

<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_open1'</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
</code></pre></div></div>

<p>With an open device, you can proceed to create and play Signals:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">% equivalent to Signal = Sine(440) * ASR(1,1,1,1) in C++</span>
<span class="n">sine</span> <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Sine_create2'</span><span class="p">,</span><span class="mi">440</span><span class="p">);</span>
<span class="n">asr</span>  <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'ASR_create'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">sig</span>  <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Product_create'</span><span class="p">,</span><span class="n">sine</span><span class="p">,</span><span class="n">asr</span><span class="p">);</span>
<span class="c1">% play Signal on channel 0 (left speaker will be audible)</span>
<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_play'</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">sig</span><span class="p">);</span>
<span class="c1">% close device</span>
<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_close'</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></div>

<p>MATLAB doesn’t know how to free the resources that Syntacts creates, so we must do so explicitly to avoid memory leaks:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">% free Signals</span>
<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Signal_delete'</span><span class="p">,</span><span class="n">sine</span><span class="p">);</span>
<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Signal_delete'</span><span class="p">,</span><span class="n">asr</span><span class="p">);</span>
<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Signal_delete'</span><span class="p">,</span><span class="n">sig</span><span class="p">);</span>
<span class="c1">% free Session</span>
<span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_delete'</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
</code></pre></div></div>

<p>Finally, when you are done using Syntacts, don’t forget to unload the library:</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">unloadlibrary</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="wrappers">Wrappers</h2>

<p>As you can see, while it is possible to use Syntacts from MATLAB, doing so is quite cumbersome. Therefore, we recommend that you create wrapper classes or functions around the Syntacts library features you plan to use. For example:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">% Syntacts.m</span>
<span class="k">classdef</span> <span class="n">Syntacts</span> <span class="o">&lt;</span> <span class="nb">handle</span>
<span class="nb">properties</span>
    <span class="n">session</span>
<span class="k">end</span>
<span class="nb">methods</span>
    <span class="c1">% constructor</span>
    <span class="k">function</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">Syntacts</span><span class="p">(</span><span class="n">dev_idx</span><span class="p">)</span>
        <span class="nb">loadlibrary</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'syntacts.h'</span><span class="p">);</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_create'</span><span class="p">);</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_open2'</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">session</span><span class="p">,</span><span class="n">dev_idx</span><span class="p">);</span>
    <span class="k">end</span>
    <span class="c1">% destructor</span>
    <span class="k">function</span> <span class="nb">delete</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_close'</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">session</span><span class="p">);</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_delete'</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">session</span><span class="p">);</span>
        <span class="nb">unloadlibrary</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">);</span>
    <span class="k">end</span>
    <span class="c1">% play sine wave Signal</span>
    <span class="k">function</span> <span class="nb">play</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">ch</span><span class="p">,</span><span class="n">freq</span><span class="p">,</span><span class="n">amp</span><span class="p">,</span><span class="n">dur</span><span class="p">)</span>
        <span class="n">sine</span> <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Sine_create2'</span><span class="p">,</span><span class="n">freq</span><span class="p">);</span>
        <span class="n">env</span>  <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Envelope_create'</span><span class="p">,</span><span class="n">dur</span><span class="p">,</span><span class="n">amp</span><span class="p">);</span>
        <span class="n">sig</span>  <span class="o">=</span> <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Product_create'</span><span class="p">,</span><span class="n">sine</span><span class="p">,</span><span class="n">env</span><span class="p">);</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Session_play'</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">session</span><span class="p">,</span><span class="n">ch</span><span class="p">,</span><span class="n">sig</span><span class="p">);</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Signal_delete'</span><span class="p">,</span><span class="n">sine</span><span class="p">);</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Signal_delete'</span><span class="p">,</span><span class="n">env</span><span class="p">);</span>
        <span class="nb">calllib</span><span class="p">(</span><span class="s1">'syntacts'</span><span class="p">,</span><span class="s1">'Signal_delete'</span><span class="p">,</span><span class="n">sig</span><span class="p">);</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">S</span> <span class="o">=</span> <span class="n">Syntacts</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>    <span class="c1">% make a Syntacts Session with device 6</span>
<span class="n">S</span><span class="o">.</span><span class="nb">play</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>  <span class="c1">% play a Signal on channel 0</span>
<span class="n">S</span><span class="o">.</span><span class="nb">play</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">% play a Signal on channel 1</span>
<span class="nb">clear</span> <span class="n">S</span>             <span class="c1">% resources will be automatically freed</span>
</code></pre></div></div>

<p>Eventually we hope to support MATLAB in an official capacity using wrapper objects similar to that presented here. If this is something you would like to help with, feel free to contribute a Pull Request on the GitHub repository!</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>
  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p>Syntacts | The Tactor Synthesizer</p>
        <a href="https://mahilab.rice.edu" target="_blank">Mechatronics and Haptic Interfaces Lab</a>
      </div>
    </div>
  </div>
</footer>
</body>

</html>
